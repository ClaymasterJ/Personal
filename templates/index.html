<!DOCTYPE html>
<html>

{% import personal.web %}
{% import personal.web.handlers as WH %}
{% import markdown %}
{% import tornado %}
{% import json %}
{% from pyfiglet import Figlet %}

<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="content-type"
          content="text/html; charset=UTF-8">


    <title>Clayton</title>

    <script src="{{ static_url( 'dist/bundle.js' ) }}"></script>

</head>

<body>
    {# {% module UI_Navbar() %} #}


    <div class="body"
         id="app">

        <!-- LINKS -->
        <div class="static-tr links">

            <a class="link"
               v-for="(linkdict, linkname) in info.links"
               :href="linkdict.url"
               :key="linkname">
                <i :class="linkdict.icon"></i>
            </a>

        </div>

        <!-- EMAIL -->
        <a class="email-header link-unstyled"
           :href="info.links['Email'].url">
            <span class="email">
                <span class="name-around">me @</span>
                <span class="name">Clayton J Roberts</span>
                <span class="name-around">. com</span>
            </span>
        </a>


        <main>
            <div class="container-fluid"
                 style="max-width: 50rem;">


                <!-- ME -->
                <div class="row align-items-center me pb-3">
                    <div class="col-auto">
                        <img class="me-portrait"
                             :src="static_url + 'src/images/me.jpg'">
                        </img>
                    </div>
                    <div class="col">
                        <span class="me-objective"
                              v-html="$options.filters.fromMarkdownToHTML(info.me.introduction)">
                            {# {% raw markdown.markdown(handler.application.info["info"]["me"]["introduction"]) %} #}

                        </span>


                    </div>


                </div>

                <!-- EXPERIENCE AND SKILLS -->
                <div class="row">
                    <div class="col pt-3">
                        <h5 class="text-muted">Experience</h5>
                        <div class="btn-group d-flex mb-3 overflow-auto">
                            <a class="btn btn-light flex-fill"
                               v-for="(expdict, expindex) in info.experience"
                               v-scroll-to="{
                                                container: '#exps',
                                                el: '#exp' + expindex,
                                                easing: 'ease-in',
                                                force: true,
                                                cancelable: true,
                                            }"
                               href="#">

                                {{! expdict.company.abbreviation ? expdict.company.abbreviation : expdict.company.name }}
                            </a>

                        </div>
                        <div class="overflow-auto sister-col"
                             id="exps">

                            {# {% for item in handler.application.info["info"]["experience"] %} #}

                            <div>
                                <exp v-for="(expdict, expindex) in info.experience"
                                     :expdict="expdict"
                                     :expindex="expindex"
                                     :key="expindex"
                                     inline-template>
                                    <div class="card"
                                         :id="'exp' + expindex">
                                        <div class="card-body">
                                            <h6 style="align-self: center"
                                                v-if="expdict.isCurrent">
                                                <span class="badge badge-primary">Current</span>
                                            </h6>

                                            <div class="d-flex justify-content-between">

                                                <div>
                                                    <h5 class="card-title">
                                                        {{! expdict.title }}
                                                    </h5>
                                                    <h6 class="text-muted card-subtitle">
                                                        {{! expdict.dateStart.month }}, {{! expdict.dateStart.year }}
                                                        <span v-if="expdict.dateEnd">- {{! expdict.dateEnd.month }}, {{! expdict.dateEnd.year }}</span>
                                                    </h6>
                                                </div>
                                                <div>
                                                    <a :href="expdict.company.link">
                                                        <img class="card-img-side"
                                                             :src="this.$parent.static_url + expdict.company.logo"
                                                             :alt="expdict.company.name">
                                                    </a>
                                                </div>


                                            </div>



                                            <div class="card-text mt-2">
                                                {# {% raw markdown.markdown(expdict.get("description", None), extensions=["extra"]) %} #}
                                                {# <vue-markdown> #}
                                                    <span v-html="$options.filters.fromMarkdownToHTML(expdict.description)"></span>

                                                    {# </vue-markdown> #}

                                            </div>
                                            <div style="text-align: right;">
                                                <a :class="'btn btn-sm ' + (isSelected ? 'btn-primary' : 'btn-light') "
                                                   @click.prevent="doSelect"
                                                   href>
                                                    <span v-if="!(isSelected)">
                                                        Show Skills
                                                    </span>
                                                    <span v-else="isSelected">
                                                        Showing Skills
                                                    </span>

                                                </a>
                                            </div>
                                            {#
                                            <a href="#"
                                               class="btn btn-primary">Go somewhere</a> #}
                                        </div>
                                    </div>
                                </exp>
                            </div>

                            {# {% end for %} #}


                        </div>
                    </div>
                    <div class="col pt-3">
                        <h5 class="text-muted"
                            style="text-align: right;">
                            Skills (<span class="text-primary">{{! _.size(info.skills.list) }}</span>)
                        </h5>
                        <div class="input-group mb-3">
                            {# <div class="input-group-prepend">
                                <span class="input-group-text"
                                      id="basic-addon1">
                                    <i class="fas fa-search"></i>
                                </span>
                            </div> #}
                            <input type="text"
                                   class="form-control faf"
                                   placeholder="&#xF002;"
                                   aria-label="Skill Search"
                                   aria-describedby="basic-addon1"
                                   style="text-align: left;"
                                   v-model="filtersearch">
                        </div>
                        <div class="overflow-auto sister-col">
                            <div class="list-group">

                                <skill v-for="(skilldict, skillkey) in info.skills.list"
                                       :skilldict="skilldict"
                                       :skillkey="skillkey"
                                       :key="skillkey"
                                       inline-template>
                                    <div class="list-group-item"
                                         v-if="doShow">
                                        <div class="row">
                                            <div class="col-2 d-flex flex-column pr-0 text-muted"
                                                 style="text-align: center; justify-content:center;">

                                                <h4 v-if="(skilldict.icon || (parentDict && parentDict.icon))"
                                                    class="m-0">
                                                    <i :class="skilldict.icon ? skilldict.icon : parentDict.icon"
                                                       style="align-self:center;"></i>
                                                </h4>
                                            </div>
                                            <div class="col d-flex flex-wrap pl-0">

                                                <div class="px-1">
                                                    {{! skillkey }}
                                                </div>
                                                <div class="px-1"
                                                     v-if="skilldict.parent">
                                                    (<span class="text-muted">{{! skilldict["parent"] }}</span>)
                                                </div>


                                            </div>


                                            {# <div class="col p-0">
                                                <!-- spacing -->
                                            </div> #}
                                            <div v-if="skilldict.link"
                                                 class="col-auto p-0"
                                                 style="text-align:right;">
                                                <a :href="skilldict.link">
                                                    <i class="far fa-question-circle"></i>
                                                </a>
                                            </div>
                                            <div class="col-auto d-flex flex-column">


                                                <div class="text-tertiary">
                                                    {# {{! this.$parent.info.skills.levels[skilldict.level] }} #}
                                                    <i class="far fa-star fa-xs"
                                                       v-for="x in _.range(3-Math.ceil(skilldict.level/2))">
                                                    </i><i class="fas fa-star fa-xs"
                                                       v-for="x in _.range(Math.ceil(skilldict.level/2))">
                                                    </i>
                                                </div>




                                            </div>
                                        </div>







                                        {# <div class="col-auto">
                                            <span>
                                                {{! this.$parent.info.skills.levels[skilldict.level] }}
                                            </span>

                                        </div> #}




                                    </div>
                                </skill>
                            </div>

                        </div>

                    </div>
                </div>


            </div>

        </main>

        <br />

        <footer style="text-align: right;">
            <small class="text-muted">
                Last-updated: {{ handler.application.info["meta"]["last updated"] }}
            </small>
        </footer>

        <footer>
            {# <div class="links">
                <h4 class="links-list">
                    {% for linkdict in handler.application.info["info"]["links"] %}
                    <span class="link">
                        <a class="text-secondary"
                           :href="{{  linkdict['url']  }}"><i :class="{{  linkdict['url']  }}"></i>
                        </a>
                    </span>
                </h4>
            </div> #}
            <!-- <h1>Contact</h1> -->

            <div class="made-with">
                <i class="fas fa-hammer"></i>
                with
                <span class="text-primary"><i class="fas fa-heart"></i></span>
                by
                <a href="https://github.com/ClaymasterJ"
                   class="text-muted">
                    ClaymasterJ
                </a>
                {# <br /> #}
                {# <small>This website is still under development due to career obligations</small> #}
            </div>
        </footer>




    </div>




</body>

<script type="text/javascript">
    Vue.component('skill', {
        template: "#skill",
        props: [
            "skilldict",
            "skillkey",
        ],
        data: function() {
            return {}
        },
        computed: {
            doShow: function() {
                // `this` points to the vm instance
                var self = this;
                if (this.$parent.filterexperiance) {
                    return (0 <= _.indexOf(this.$parent.filterexperiance, self.skillkey))
                }
                else if (this.$parent.filtersearch) {
                    return (self.skillkey.includes(self.$parent.filtersearch) || (self.skilldict.parent && self.skilldict.parent.includes(self.$parent.filtersearch)));
                }
                else {
                    return true;
                }

            },
            parentDict: function() {
                var self = this;
                if (self.skilldict.parent) {
                    return this.$parent.info.skills.list[self.skilldict.parent];
                }
                else {
                    return null;
                }
            }
        },
        methods: {},
    });

    Vue.component('exp', {
        template: "#exp",
        props: [
            "expdict",
            "expindex"
        ],
        data: function() {
            return {}
        },
        computed: {
            isSelected: function() {
                var self = this;
                return (self.expindex == self.$parent.selectedexperiance);
            }
        },
        methods: {
            doSelect: function() {
                var self = this;
                if (self.isSelected) {
                    self.$parent.selectedexperiance = null;
                }
                else {
                    self.$parent.selectedexperiance = self.expindex;
                }
            },

        },
    });

    var app = new Vue({
        el: '#app',
        components: {
            VueMarkdown,
        },
        data: function() {
            // Following line is from tornado
            // var a = String.raw  //.replace("&#39;", "'")
            // alert(a);
            //
            // console.log(JSON.parse(String.raw `{% raw json.dumps(handler.application.info) %}`));
            return {
                ...{
                    filtersearch: null,

                    selectedexperiance: null,
                    static_url: `{% raw static_url("") %}`
                },
                ...JSON.parse(String.raw `{% raw json.dumps(handler.application.info) %}`)


            }
        },
        methods: {
            fromMarkdownToHTML: function(x) {
                return mdconverter.makeHTML(x);
            }
        },
        computed: {
            filterexperiance: function() {
                var self = this;
                // self.selectedexperiance = null;
                var a = null;
                if (self.selectedexperiance) {
                    a = self.info.experience[self.selectedexperiance].skillList;
                }
                return a;

            }
        }
    })

    // -> PYTHON
    // {% set f = Figlet() %}
    // {% set s = json.dumps(f.renderText('ClaymasterJ')).replace("`", r"\u0060") %}

    var a = JSON.parse(String.raw `{% raw s %}`.replace(String.raw `\u0060`, "\u0060"));

    console.log(`Made by ...

        ${a}

        ~~~ https://github.com/ClaymasterJ ~~~
        \n\n

        Feel free to use anything you find here!
        \n
        (The text art was created by PyFiglet (https://github.com/pwaller/pyfiglet))
        \n\n
        This site is dedicated to Kristen, whom has always believed in my dreams and goals, even when I do not. <3
        `);

</script>




</html>
